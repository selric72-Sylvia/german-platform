<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>28å¤©å­¦ä¹ è®¡åˆ’</title>
<link rel="stylesheet" href="../assets/style.css">
</head>

<body>

<a href="../index.html" class="back">â† è¿”å›é¦–é¡µ</a>
<h2>ğŸ“… Sylvia çš„ 28 å¤©å­¦ä¹ è®¡åˆ’</h2>

<div class="progressBar">
    <div id="overallProgress" class="progressFill"></div>
</div>
<p id="overallText" class="center"></p>

<table>
    <tr>
        <th>å¤©æ•°</th>
        <th>è¯­æ³•ä»»åŠ¡</th>
        <th>è¯æ±‡ä»»åŠ¡</th>
        <th>è¯¾æœ¬å¤ä¹ </th>
        <th>å®Œæˆç‡</th>
    </tr>
    <tbody id="planTable"></tbody>
</table>

<script>
let plan = JSON.parse(localStorage.getItem("sylvia_28day") || "[]");

if (plan.length === 0) {
    for (let i = 1; i <= 28; i++) {
        plan.push({ day: i, grammar: false, vocab: false, book: false });
    }
    localStorage.setItem("sylvia_28day", JSON.stringify(plan));
}

function renderPlan() {
    const tb = document.getElementById("planTable");
    tb.innerHTML = "";

    let total = 0, done = 0;

    plan.forEach((d, idx) => {
        let finished = [d.grammar, d.vocab, d.book].filter(Boolean).length;
        let rate = Math.round(finished / 3 * 100);

        total += 3;
        done += finished;

        tb.innerHTML += `
        <tr>
            <td>ç¬¬ ${d.day} å¤©</td>
            <td class="${d.grammar?'done':''}" onclick="toggle(${idx}, 'grammar')">è¯­æ³•</td>
            <td class="${d.vocab?'done':''}" onclick="toggle(${idx}, 'vocab')">è¯æ±‡</td>
            <td class="${d.book?'done':''}" onclick="toggle(${idx}, 'book')">è¯¾æœ¬</td>
            <td>${rate}%</td>
        </tr>`;
    });

    let overall = Math.round(done / total * 100);
    document.getElementById("overallProgress").style.width = overall + "%";
    document.getElementById("overallText").innerText = `æ•´ä½“è¿›åº¦ï¼š${overall}%`;
}

function toggle(i, key) {
    plan[i][key] = !plan[i][key];
    localStorage.setItem("sylvia_28day", JSON.stringify(plan));
    renderPlan();
}

renderPlan();
</script>

</body>
</html>
